import{e as X,i as u,m as y,s as Y,u as q,c as i,o as d,a as t,D as p,b as r,d as F,h as J,t as l,g as o,E as b,G as $,Y as k,X as A,O as P,F as B,r as I,n as C,H as M,_ as tt}from"./CHqgt15z.js";const st={class:"notifications-page space-y-4"},et={class:"page-header"},at={class:"header-content"},ot={class:"header-right"},lt={class:"stats-grid"},nt={class:"stat-card"},it={class:"stat-icon"},dt={class:"stat-content"},ct={class:"stat-value"},rt={class:"stat-card"},ut={class:"stat-icon"},_t={class:"stat-content"},vt={class:"stat-value"},pt={class:"stat-card"},mt={class:"stat-icon"},ft={class:"stat-content"},gt={class:"stat-value"},ht={class:"stat-card"},yt={class:"stat-icon"},bt={class:"stat-content"},kt={class:"stat-value"},Ct={class:"filters-section"},Nt={class:"filters-container"},wt={class:"search-box"},xt={class:"filter-controls"},Mt={class:"notifications-container"},Tt={key:0,class:"loading-state"},Dt={key:1,class:"empty-state"},St={key:2,class:"notifications-list"},Vt=["onClick"],Lt={class:"notification-icon"},Et={class:"notification-content"},Zt={class:"notification-header"},Ft={class:"notification-title"},$t={class:"notification-meta"},At={class:"notification-date"},Bt={class:"notification-message"},It={key:0,class:"notification-data"},Ut={key:0,class:"data-item"},Ht={class:"data-value"},Ot={key:1,class:"data-item"},Rt={class:"data-value"},Wt={class:"notification-actions"},jt=["onClick"],zt=["onClick"],Gt={class:"modal-header"},Kt={key:0,class:"modal-body"},Qt={class:"notification-details"},Xt={class:"detail-header"},Yt={class:"detail-icon"},qt={class:"detail-info"},Jt={class:"detail-title"},Pt={class:"detail-meta"},ts={class:"detail-date"},ss={class:"detail-content"},es={class:"content-message"},as={key:0,class:"detail-data"},os={class:"data-items"},ls={class:"data-label"},ns={class:"data-value"},is={class:"modal-actions"},ds=X({__name:"index",setup(cs){const _=u([]),N=u(!0),v=u(""),m=u(""),f=u(""),g=u(""),w=u(!1),n=u(null),T=y(()=>{let e=_.value;return v.value&&(e=e.filter(s=>s.title.toLowerCase().includes(v.value.toLowerCase())||s.message.toLowerCase().includes(v.value.toLowerCase()))),m.value&&(e=e.filter(s=>s.status===m.value)),f.value&&(e=e.filter(s=>s.type===f.value)),g.value&&(e=e.filter(s=>s.created_at.startsWith(g.value))),e}),U=y(()=>_.value.length),H=y(()=>_.value.filter(e=>e.status==="unread").length),O=y(()=>_.value.filter(e=>e.status==="read").length),R=y(()=>{const e=new Date().toISOString().slice(0,10);return _.value.filter(s=>s.created_at.startsWith(e)).length}),D=e=>({booking:"حجز جديد",message:"رسالة جديدة",system:"نظام",alert:"تنبيه"})[e]||e,S=e=>({booking:"lucide:calendar",message:"lucide:mail",system:"lucide:settings",alert:"lucide:alert-triangle"})[e]||"lucide:bell",W=e=>({booking_id:"رقم الحجز",customer_name:"اسم العميل",amount:"المبلغ",status:"الحالة"})[e]||e,j=e=>new Date(e).toLocaleDateString("ar-SA"),z=e=>new Date(e).toLocaleString("ar-SA"),V=async()=>{try{N.value=!0,_.value=[{id:"notif-001",title:"حجز جديد",message:"تم إنشاء حجز جديد من العميل أحمد محمد",type:"booking",status:"unread",data:{booking_id:"BK-001",customer_name:"أحمد محمد",amount:"5000 ريال"},created_at:"2024-01-21T10:00:00Z",updated_at:"2024-01-21T10:00:00Z"},{id:"notif-002",title:"رسالة جديدة",message:"رسالة جديدة من العميل فاطمة علي",type:"message",status:"unread",data:{customer_name:"فاطمة علي",subject:"استفسار عن رحلة دبي"},created_at:"2024-01-21T09:30:00Z",updated_at:"2024-01-21T09:30:00Z"},{id:"notif-003",title:"تحديث النظام",message:"تم تحديث النظام بنجاح",type:"system",status:"read",created_at:"2024-01-20T15:00:00Z",updated_at:"2024-01-20T15:00:00Z"}]}catch(e){console.error("Error loading notifications:",e)}finally{N.value=!1}},G=e=>{n.value=e,w.value=!0,e.status==="unread"&&(e.status="read")},L=async e=>{try{const s=e.status==="read"?"unread":"read";e.status=s,console.log("Toggle notification status:",e.id,s)}catch(s){console.error("Error toggling notification status:",s)}},K=async e=>{if(confirm(`هل أنت متأكد من حذف الإشعار "${e.title}"؟`))try{console.log("Delete notification:",e.id),await V()}catch(s){console.error("Error deleting notification:",s)}},Q=async()=>{try{_.value.forEach(e=>{e.status==="unread"&&(e.status="read")})}catch(e){console.error("Error marking all as read:",e)}},x=()=>{w.value=!1,n.value=null};return Y(()=>{V()}),q({title:"الإشعارات - لوحة التحكم"}),(e,s)=>{var E,Z;const c=J;return d(),i("div",st,[t("div",et,[t("div",at,[s[7]||(s[7]=t("div",{class:"header-left"},[t("h1",{class:"page-title"},"الإشعارات"),t("p",{class:"page-subtitle"},"إدارة جميع الإشعارات والتنبيهات")],-1)),t("div",ot,[t("button",{onClick:Q,class:"mark-read-btn"},[r(c,{name:"lucide:check",class:"btn-icon"}),s[6]||(s[6]=F(" تعيين الكل كمقروء "))])])])]),t("div",lt,[t("div",nt,[t("div",it,[r(c,{name:"lucide:bell",class:"icon"})]),t("div",dt,[t("p",ct,l(o(U)),1),s[8]||(s[8]=t("p",{class:"stat-label"},"إجمالي الإشعارات",-1))])]),t("div",rt,[t("div",ut,[r(c,{name:"lucide:bell-ring",class:"icon"})]),t("div",_t,[t("p",vt,l(o(H)),1),s[9]||(s[9]=t("p",{class:"stat-label"},"غير مقروء",-1))])]),t("div",pt,[t("div",mt,[r(c,{name:"lucide:mail-open",class:"icon"})]),t("div",ft,[t("p",gt,l(o(O)),1),s[10]||(s[10]=t("p",{class:"stat-label"},"مقروء",-1))])]),t("div",ht,[t("div",yt,[r(c,{name:"lucide:calendar",class:"icon"})]),t("div",bt,[t("p",kt,l(o(R)),1),s[11]||(s[11]=t("p",{class:"stat-label"},"اليوم",-1))])])]),t("div",Ct,[t("div",Nt,[t("div",wt,[r(c,{name:"lucide:search",class:"search-icon"}),b(t("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>k(v)?v.value=a:null),type:"text",placeholder:"البحث في الإشعارات...",class:"search-input"},null,512),[[$,o(v)]])]),t("div",xt,[b(t("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>k(m)?m.value=a:null),class:"filter-select"},s[12]||(s[12]=[t("option",{value:""},"جميع الحالات",-1),t("option",{value:"unread"},"غير مقروء",-1),t("option",{value:"read"},"مقروء",-1)]),512),[[A,o(m)]]),b(t("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>k(f)?f.value=a:null),class:"filter-select"},s[13]||(s[13]=[P('<option value="" data-v-1f22fa90>جميع الأنواع</option><option value="booking" data-v-1f22fa90>حجز جديد</option><option value="message" data-v-1f22fa90>رسالة جديدة</option><option value="system" data-v-1f22fa90>نظام</option><option value="alert" data-v-1f22fa90>تنبيه</option>',5)]),512),[[A,o(f)]]),b(t("input",{"onUpdate:modelValue":s[3]||(s[3]=a=>k(g)?g.value=a:null),type:"date",class:"filter-select",placeholder:"تاريخ الإشعار"},null,512),[[$,o(g)]])])])]),t("div",Mt,[o(N)?(d(),i("div",Tt,s[14]||(s[14]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"جاري تحميل الإشعارات...",-1)]))):o(T).length===0?(d(),i("div",Dt,[r(c,{name:"lucide:bell-off",class:"empty-icon"}),s[15]||(s[15]=t("h3",null,"لا توجد إشعارات",-1)),s[16]||(s[16]=t("p",null,"لم يتم العثور على أي إشعارات تطابق معايير البحث",-1))])):(d(),i("div",St,[(d(!0),i(B,null,I(o(T),a=>(d(),i("div",{key:a.id,class:C(["notification-card",{unread:a.status==="unread"}]),onClick:h=>G(a)},[t("div",Lt,[r(c,{name:S(a.type),class:"icon"},null,8,["name"])]),t("div",Et,[t("div",Zt,[t("h3",Ft,l(a.title),1),t("div",$t,[t("span",{class:C(["notification-type",a.type])},l(D(a.type)),3),t("span",At,l(j(a.created_at)),1)])]),t("p",Bt,l(a.message),1),a.data?(d(),i("div",It,[a.data.booking_id?(d(),i("div",Ut,[s[17]||(s[17]=t("span",{class:"data-label"},"رقم الحجز:",-1)),t("span",Ht,"#"+l(a.data.booking_id),1)])):p("",!0),a.data.customer_name?(d(),i("div",Ot,[s[18]||(s[18]=t("span",{class:"data-label"},"العميل:",-1)),t("span",Rt,l(a.data.customer_name),1)])):p("",!0)])):p("",!0)]),t("div",Wt,[t("button",{onClick:M(h=>L(a),["stop"]),class:C(["action-btn status",{read:a.status==="read"}])},[r(c,{name:a.status==="read"?"lucide:mail-open":"lucide:mail",class:"action-icon"},null,8,["name"])],10,jt),t("button",{onClick:M(h=>K(a),["stop"]),class:"action-btn delete"},[r(c,{name:"lucide:trash-2",class:"action-icon"})],8,zt)])],10,Vt))),128))]))]),o(w)?(d(),i("div",{key:0,class:"modal-overlay",onClick:x},[t("div",{class:"modal-content",onClick:s[5]||(s[5]=M(()=>{},["stop"]))},[t("div",Gt,[s[19]||(s[19]=t("h2",{class:"modal-title"},"تفاصيل الإشعار",-1)),t("button",{onClick:x,class:"modal-close"},[r(c,{name:"lucide:x",class:"close-icon"})])]),o(n)?(d(),i("div",Kt,[t("div",Qt,[t("div",Xt,[t("div",Yt,[r(c,{name:S(o(n).type),class:"icon-large"},null,8,["name"])]),t("div",qt,[t("h3",Jt,l(o(n).title),1),t("div",Pt,[t("span",{class:C(["detail-type",o(n).type])},l(D(o(n).type)),3),t("span",ts,l(z(o(n).created_at)),1)])])]),t("div",ss,[s[20]||(s[20]=t("h4",{class:"content-title"},"الرسالة",-1)),t("p",es,l(o(n).message),1)]),o(n).data?(d(),i("div",as,[s[21]||(s[21]=t("h4",{class:"data-title"},"البيانات الإضافية",-1)),t("div",os,[(d(!0),i(B,null,I(o(n).data,(a,h)=>(d(),i("div",{key:h,class:"data-item"},[t("span",ls,l(W(h))+":",1),t("span",ns,l(a),1)]))),128))])])):p("",!0)])])):p("",!0),t("div",is,[t("button",{onClick:x,class:"btn-secondary"}," إغلاق "),t("button",{onClick:s[4]||(s[4]=a=>L(o(n))),class:"btn-primary"},[r(c,{name:((E=o(n))==null?void 0:E.status)==="read"?"lucide:mail":"lucide:mail-open",class:"btn-icon"},null,8,["name"]),F(" "+l((((Z=o(n))==null?void 0:Z.status)==="read","تعيين كمقروء")),1)])])])])):p("",!0)])}}}),us=tt(ds,[["__scopeId","data-v-1f22fa90"]]);export{us as default};
