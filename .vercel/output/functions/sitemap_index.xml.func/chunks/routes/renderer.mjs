import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as r,getPrefetchLinks as n}from"vue-bundle-renderer/runtime";import{e as o,b as s,f as a,h as i,i as d,j as l,a as u,c,k as p,u as h}from"../_/nitro.mjs";import{createHead as f,propsToString as m,renderSSRHead as y}from"unhead/server";import{walkResolver as g}from"unhead/utils";import{toValue as b,isRef as w,hasInjectionContext as _,inject as v,ref as x,watchEffect as C,getCurrentInstance as j,onBeforeUnmount as S,onDeactivated as A,onActivated as T}from"vue";import{renderToString as R}from"vue/server-renderer";import{stringify as k,uneval as H}from"devalue";import{DeprecationsPlugin as P,PromisesPlugin as $,TemplateParamsPlugin as L,AliasSortingPlugin as U}from"unhead/plugins";const VueResolver=(e,t)=>w(t)?b(t):t,z="usehead";function useHead(e,t={}){const r=t.head||function(){if(_()){const e=v(z);if(!e)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return e}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}();return r.ssr?r.push(e||{},t):function(e,t,r={}){const n=x(!1);let o;C((()=>{const s=n.value?{}:g(t,VueResolver);o?o.patch(s):o=e.push(s,r)}));j()&&(S((()=>{o.dispose()})),A((()=>{n.value=!0})),T((()=>{n.value=!1})));return o}(r,e,t)}function useServerHead(e,t={}){return useHead(e,{...t,mode:"server"})}function createHead(e={}){const t=f({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(z,e)}}.install}(t),t}const O={meta:[{charset:"utf-8"},{name:"viewport",content:"width=device-width, initial-scale=1"},{name:"description",content:"Your trusted travel partner for unforgettable experiences"}],link:[{rel:"preconnect",href:"https://fonts.googleapis.com"},{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},{rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Cairo:wght@200;300;400;500;600;700;800;900&display=swap"}],style:[],script:[],noscript:[],title:"Wonder Land",htmlAttrs:{lang:"ar-SA",dir:"rtl"}},M={id:"teleports"},N=`<div${m({id:"__nuxt"})}>`,E="</div>",getClientManifest=()=>import("../build/client.manifest.mjs").then((e=>e.default||e)).then((e=>"function"==typeof e?e():e)),F=lazyCachedFunction((()=>import("../build/styles.mjs").then((e=>e.default||e)))),D=lazyCachedFunction((async()=>{const t=await getClientManifest();if(!t)throw new Error("client.manifest is not available");const r=await import("../build/server.mjs").then((function(e){return e.j})).then((e=>e.default||e));if(!r)throw new Error("Server bundle is not available");return e(r,{manifest:t,renderToString:async function(e,t){const r=await R(e,t);return N+r+E},buildAssetsURL:o})})),I=lazyCachedFunction((async()=>{const t=await getClientManifest(),r=await import("../virtual/_virtual_spa-template.mjs").then((e=>e.template)).catch((()=>"")).then((e=>N+e+E)),n=e((()=>()=>{}),{manifest:t,renderToString:()=>r,buildAssetsURL:o}),a=await n.renderToString({});return{rendererContext:n.rendererContext,renderToString:e=>{const t=s(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(a)}}}));function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch((e=>{throw t=null,e}))),t)}function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?k(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${H(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:r,...n}=e.payload;return{initial:{...n,prerenderedAt:r},payload:{data:t,prerenderedAt:r}}}const X={disableDefaults:!0,disableCapoSorting:!1,plugins:[P,$,L,U]},q={omitLineBreaks:!1};globalThis.__buildAssetsURL=o,globalThis.__publicAssetsURL=l;const B=!!M.id,J=B?`<div${m(M)}>`:"",W=B?"</div>":"",Y=/^[^?]*\/_payload.json(?:\?.*)?$/,G=d((async e=>{const d=h(),l=e.path.startsWith("/__nuxt_error")?u(e):null;if(l&&l.statusCode&&(l.statusCode=Number.parseInt(l.statusCode)),l&&!("__unenv__"in e.node.req))throw c({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const f=void 0;let m=l?.url||e.path;const g=Y.test(m);g&&(m=m.substring(0,m.lastIndexOf("/"))||"/",e._path=m,e.node.req.url=m);const b=p(e),w=createHead(X),_={mode:"server"};w.push(O,_);const v={url:m,event:e,runtimeConfig:s(e),noSSR:e.context.nuxt?.noSSR||!1===b.ssr&&!0||!1,head:w,error:!!l,nuxt:void 0,payload:l?{error:l}:{},_payloadReducers:Object.create(null),modules:new Set,islandContext:f},x=v.noSSR?await I():await D();for(const e of await getClientManifest().then((e=>Object.values(e).filter((e=>e._globalCSS)).map((e=>e.src)))))v.modules.add(e);const C=await x.renderToString(v).catch((async e=>{if(v._renderResponse&&"skipping render"===e.message)return{};const t=!l&&v.payload?.error||e;throw await(v.nuxt?.hooks.callHook("app:error",t)),t}));if(await(v.nuxt?.hooks.callHook("app:rendered",{ssrContext:v,renderResult:C})),v._renderResponse)return v._renderResponse;if(v.payload?.error&&!l)throw v.payload.error;if(g){const e=function(e){return{body:k(splitPayload(e).payload,e._payloadReducers),statusCode:i(e.event),statusMessage:a(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(v);return e}const j=await async function(e){const t=await F(),r=new Set;for(const n of e)if(n in t&&t[n])for(const e of await t[n]())r.add(e);return Array.from(r).map((e=>({innerHTML:e})))}(v.modules??[]),S=b.noScripts,{styles:A,scripts:T}=t(v,x.rendererContext);v._preloadManifest&&w.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:o(`builds/meta/${v.runtimeConfig.app.buildId}.json`)}]},{..._,tagPriority:"low"}),j.length&&w.push({style:j});{const e=[];for(const t of Object.values(A))e.push({rel:"stylesheet",href:x.rendererContext.buildAssetsURL(t.file),crossorigin:""});e.length&&w.push({link:e},_)}S||(w.push({link:r(v,x.rendererContext)},_),w.push({link:n(v,x.rendererContext)},_),w.push({script:renderPayloadJsonScript({ssrContext:v,data:v.payload})},{..._,tagPosition:"bodyClose",tagPriority:"high"})),b.noScripts||w.push({script:Object.values(T).map((e=>({type:e.module?"module":null,src:x.rendererContext.buildAssetsURL(e.file),defer:!e.module||null,tagPosition:"head",crossorigin:""})))},_);const{headTags:R,bodyTags:H,bodyTagsOpen:P,htmlAttrs:$,bodyAttrs:L}=await y(w,q),U={island:false,htmlAttrs:$?[$]:[],head:normalizeChunks([R]),bodyAttrs:L?[L]:[],bodyPrepend:normalizeChunks([P,v.teleports?.body]),body:[C.html,J+(B?joinTags([v.teleports?.[`#${M.id}`]]):"")+W],bodyAppend:[H]};await d.hooks.callHook("render:html",U,{event:e});var z;return{body:(z=U,`<!DOCTYPE html><html${joinAttrs(z.htmlAttrs)}><head>${joinTags(z.head)}</head><body${joinAttrs(z.bodyAttrs)}>${joinTags(z.bodyPrepend)}${joinTags(z.body)}${joinTags(z.bodyAppend)}</body></html>`),statusCode:i(e),statusMessage:a(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}}}));function normalizeChunks(e){return e.filter(Boolean).map((e=>e.trim()))}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const K=Object.freeze({__proto__:null,default:G});export{useServerHead as a,z as h,K as r,useHead as u};
//# sourceMappingURL=renderer.mjs.map
