import{H as a,q as e,s}from"./server.mjs";import{defineComponent as t,ref as d,computed as l,mergeProps as i,unref as v,useSSRContext as n}from"vue";import{ssrRenderAttrs as r,ssrRenderComponent as c,ssrInterpolate as o,ssrRenderAttr as p,ssrIncludeBooleanAttr as u,ssrLooseContain as f,ssrLooseEqual as m,ssrRenderList as g,ssrRenderClass as h}from"vue/server-renderer";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"@iconify/utils";import"node:crypto";import"consola";import"node:module";import"node:url";import"ipx";import"node:fs";import"node:path";import"vue-router";import"@supabase/ssr";import"@iconify/vue";import"../routes/renderer.mjs";import"vue-bundle-renderer/runtime";import"unhead/server";import"unhead/utils";import"devalue";import"unhead/plugins";import"@unhead/schema-org";import"@unhead/schema-org/vue";import"floating-vue";import"@iconify/utils/lib/css/icon";const y=t({__name:"index",__ssrInlineRender:!0,setup(s){const t=d([]),n=d(!0),y=d(!1),b=d(""),$=d(""),A=d(""),_=d(""),w=d(!1),j=d(!1),C=d(null),k=d({message:""}),q=l((()=>{let a=t.value;return b.value&&(a=a.filter((a=>a.sender_name.toLowerCase().includes(b.value.toLowerCase())||a.sender_email.toLowerCase().includes(b.value.toLowerCase())||a.subject.toLowerCase().includes(b.value.toLowerCase())||a.message.toLowerCase().includes(b.value.toLowerCase())))),$.value&&(a=a.filter((a=>a.status===$.value))),A.value&&(a=a.filter((a=>a.type===A.value))),_.value&&(a=a.filter((a=>a.created_at.startsWith(_.value)))),a})),S=l((()=>t.value.length)),D=l((()=>t.value.filter((a=>"unread"===a.status)).length)),I=l((()=>t.value.filter((a=>"replied"===a.status)).length)),R=l((()=>t.value.filter((a=>"pending"===a.status)).length)),x=a=>({inquiry:"استفسار",complaint:"شكوى",suggestion:"اقتراح",booking:"حجز"}[a]||a),L=a=>new Date(a).toLocaleString("ar-SA");return a({title:"إدارة الرسائل - لوحة التحكم"}),(a,s,t,d)=>{const l=e;s(`<div${r(i({class:"messages-page space-y-4"},d))} data-v-e1303f5a><div class="page-header" data-v-e1303f5a><div class="header-content" data-v-e1303f5a><div class="header-left" data-v-e1303f5a><h1 class="page-title" data-v-e1303f5a>إدارة الرسائل</h1><p class="page-subtitle" data-v-e1303f5a>إدارة رسائل التواصل من العملاء</p></div><div class="header-right" data-v-e1303f5a><button class="mark-read-btn" data-v-e1303f5a>`),s(c(l,{name:"lucide:check",class:"btn-icon"},null,t)),s(' تعيين الكل كمقروء </button></div></div></div><div class="stats-grid" data-v-e1303f5a><div class="stat-card" data-v-e1303f5a><div class="stat-icon" data-v-e1303f5a>'),s(c(l,{name:"lucide:mail",class:"icon"},null,t)),s(`</div><div class="stat-content" data-v-e1303f5a><p class="stat-value" data-v-e1303f5a>${o(v(S))}</p><p class="stat-label" data-v-e1303f5a>إجمالي الرسائل</p></div></div><div class="stat-card" data-v-e1303f5a><div class="stat-icon" data-v-e1303f5a>`),s(c(l,{name:"lucide:mail-open",class:"icon"},null,t)),s(`</div><div class="stat-content" data-v-e1303f5a><p class="stat-value" data-v-e1303f5a>${o(v(D))}</p><p class="stat-label" data-v-e1303f5a>الرسائل غير المقروءة</p></div></div><div class="stat-card" data-v-e1303f5a><div class="stat-icon" data-v-e1303f5a>`),s(c(l,{name:"lucide:reply",class:"icon"},null,t)),s(`</div><div class="stat-content" data-v-e1303f5a><p class="stat-value" data-v-e1303f5a>${o(v(I))}</p><p class="stat-label" data-v-e1303f5a>الرسائل المجابة</p></div></div><div class="stat-card" data-v-e1303f5a><div class="stat-icon" data-v-e1303f5a>`),s(c(l,{name:"lucide:clock",class:"icon"},null,t)),s(`</div><div class="stat-content" data-v-e1303f5a><p class="stat-value" data-v-e1303f5a>${o(v(R))}</p><p class="stat-label" data-v-e1303f5a>في الانتظار</p></div></div></div><div class="filters-section" data-v-e1303f5a><div class="filters-container" data-v-e1303f5a><div class="search-box" data-v-e1303f5a>`),s(c(l,{name:"lucide:search",class:"search-icon"},null,t)),s(`<input${p("value",v(b))} type="text" placeholder="البحث في الرسائل..." class="search-input" data-v-e1303f5a></div><div class="filter-controls" data-v-e1303f5a><select class="filter-select" data-v-e1303f5a><option value="" data-v-e1303f5a${u(Array.isArray(v($))?f(v($),""):m(v($),""))?" selected":""}>جميع الحالات</option><option value="unread" data-v-e1303f5a${u(Array.isArray(v($))?f(v($),"unread"):m(v($),"unread"))?" selected":""}>غير مقروء</option><option value="read" data-v-e1303f5a${u(Array.isArray(v($))?f(v($),"read"):m(v($),"read"))?" selected":""}>مقروء</option><option value="replied" data-v-e1303f5a${u(Array.isArray(v($))?f(v($),"replied"):m(v($),"replied"))?" selected":""}>مجاب</option><option value="pending" data-v-e1303f5a${u(Array.isArray(v($))?f(v($),"pending"):m(v($),"pending"))?" selected":""}>في الانتظار</option></select><select class="filter-select" data-v-e1303f5a><option value="" data-v-e1303f5a${u(Array.isArray(v(A))?f(v(A),""):m(v(A),""))?" selected":""}>جميع الأنواع</option><option value="inquiry" data-v-e1303f5a${u(Array.isArray(v(A))?f(v(A),"inquiry"):m(v(A),"inquiry"))?" selected":""}>استفسار</option><option value="complaint" data-v-e1303f5a${u(Array.isArray(v(A))?f(v(A),"complaint"):m(v(A),"complaint"))?" selected":""}>شكوى</option><option value="suggestion" data-v-e1303f5a${u(Array.isArray(v(A))?f(v(A),"suggestion"):m(v(A),"suggestion"))?" selected":""}>اقتراح</option><option value="booking" data-v-e1303f5a${u(Array.isArray(v(A))?f(v(A),"booking"):m(v(A),"booking"))?" selected":""}>حجز</option></select><input${p("value",v(_))} type="date" class="filter-select" placeholder="تاريخ الرسالة" data-v-e1303f5a></div></div></div><div class="messages-container" data-v-e1303f5a>`),v(n)?s('<div class="loading-state" data-v-e1303f5a><div class="loading-spinner" data-v-e1303f5a></div><p data-v-e1303f5a>جاري تحميل الرسائل...</p></div>'):0===v(q).length?(s('<div class="empty-state" data-v-e1303f5a>'),s(c(l,{name:"lucide:mail",class:"empty-icon"},null,t)),s("<h3 data-v-e1303f5a>لا توجد رسائل</h3><p data-v-e1303f5a>لم يتم العثور على أي رسائل تطابق معايير البحث</p></div>")):(s('<div class="messages-list" data-v-e1303f5a>\x3c!--[--\x3e'),g(v(q),(a=>{s(`<div class="${h([{unread:"unread"===a.status},"message-card"])}" data-v-e1303f5a><div class="message-header" data-v-e1303f5a><div class="sender-info" data-v-e1303f5a><div class="sender-avatar" data-v-e1303f5a>`),s(c(l,{name:"lucide:user",class:"avatar-icon"},null,t)),s(`</div><div class="sender-details" data-v-e1303f5a><h3 class="sender-name" data-v-e1303f5a>${o(a.sender_name)}</h3><p class="sender-email" data-v-e1303f5a>${o(a.sender_email)}</p></div></div><div class="message-meta" data-v-e1303f5a><span class="${h([a.type,"message-type"])}" data-v-e1303f5a>${o(x(a.type))}</span><span class="message-date" data-v-e1303f5a>${o((a=>new Date(a).toLocaleDateString("ar-SA"))(a.created_at))}</span></div></div><div class="message-content" data-v-e1303f5a><h4 class="message-subject" data-v-e1303f5a>${o(a.subject)}</h4><p class="message-preview" data-v-e1303f5a>${o(a.message)}</p></div><div class="message-footer" data-v-e1303f5a><div class="message-status" data-v-e1303f5a><span class="${h([a.status,"status-badge"])}" data-v-e1303f5a>${o((a=>({unread:"غير مقروء",read:"مقروء",replied:"مجاب",pending:"في الانتظار"}[a]||a))(a.status))}</span></div><div class="message-actions" data-v-e1303f5a><button class="action-btn reply" data-v-e1303f5a>`),s(c(l,{name:"lucide:reply",class:"action-icon"},null,t)),s(' رد </button><button class="action-btn delete" data-v-e1303f5a>'),s(c(l,{name:"lucide:trash-2",class:"action-icon"},null,t)),s(" حذف </button></div></div></div>")})),s("\x3c!--]--\x3e</div>")),s("</div>"),v(w)?(s('<div class="modal-overlay" data-v-e1303f5a><div class="modal-content large" data-v-e1303f5a><div class="modal-header" data-v-e1303f5a><h2 class="modal-title" data-v-e1303f5a>تفاصيل الرسالة</h2><button class="modal-close" data-v-e1303f5a>'),s(c(l,{name:"lucide:x",class:"close-icon"},null,t)),s("</button></div>"),v(C)?(s('<div class="modal-body" data-v-e1303f5a><div class="message-details" data-v-e1303f5a><div class="message-header-detail" data-v-e1303f5a><div class="sender-info-detail" data-v-e1303f5a><div class="sender-avatar-large" data-v-e1303f5a>'),s(c(l,{name:"lucide:user",class:"avatar-icon-large"},null,t)),s(`</div><div class="sender-details-large" data-v-e1303f5a><h3 class="sender-name-large" data-v-e1303f5a>${o(v(C).sender_name)}</h3><p class="sender-email-large" data-v-e1303f5a>${o(v(C).sender_email)}</p><p class="sender-phone" data-v-e1303f5a>${o(v(C).sender_phone)}</p></div></div><div class="message-meta-detail" data-v-e1303f5a><span class="${h([v(C).type,"message-type-large"])}" data-v-e1303f5a>${o(x(v(C).type))}</span><span class="message-date-large" data-v-e1303f5a>${o(L(v(C).created_at))}</span></div></div><div class="message-content-detail" data-v-e1303f5a><h4 class="message-subject-large" data-v-e1303f5a>${o(v(C).subject)}</h4><div class="message-text" data-v-e1303f5a>${o(v(C).message)}</div></div>`),v(C).replies&&v(C).replies.length>0?(s('<div class="replies-section" data-v-e1303f5a><h4 class="replies-title" data-v-e1303f5a>الردود</h4><div class="replies-list" data-v-e1303f5a>\x3c!--[--\x3e'),g(v(C).replies,(a=>{s(`<div class="reply-item" data-v-e1303f5a><div class="reply-header" data-v-e1303f5a><span class="reply-author" data-v-e1303f5a>${o(a.author_name)}</span><span class="reply-date" data-v-e1303f5a>${o(L(a.created_at))}</span></div><div class="reply-content" data-v-e1303f5a>${o(a.message)}</div></div>`)})),s("\x3c!--]--\x3e</div></div>")):s("\x3c!----\x3e"),s("</div></div>")):s("\x3c!----\x3e"),s('<div class="modal-actions" data-v-e1303f5a><button class="btn-secondary" data-v-e1303f5a> إغلاق </button><button class="btn-primary" data-v-e1303f5a>'),s(c(l,{name:"lucide:reply",class:"btn-icon"},null,t)),s(" رد على الرسالة </button></div></div></div>")):s("\x3c!----\x3e"),v(j)?(s('<div class="modal-overlay" data-v-e1303f5a><div class="modal-content" data-v-e1303f5a><div class="modal-header" data-v-e1303f5a><h2 class="modal-title" data-v-e1303f5a>رد على الرسالة</h2><button class="modal-close" data-v-e1303f5a>'),s(c(l,{name:"lucide:x",class:"close-icon"},null,t)),s(`</button></div><form class="modal-form" data-v-e1303f5a><div class="form-group" data-v-e1303f5a><label class="form-label" data-v-e1303f5a>الرد *</label><textarea class="form-textarea" rows="6" required placeholder="اكتب ردك هنا..." data-v-e1303f5a>${o(v(k).message)}</textarea></div><div class="modal-actions" data-v-e1303f5a><button type="button" class="btn-secondary" data-v-e1303f5a> إلغاء </button><button type="submit" class="btn-primary"${u(v(y))?" disabled":""} data-v-e1303f5a>`),v(y)?s(c(l,{name:"lucide:loader-2",class:"btn-icon animate-spin"},null,t)):s(c(l,{name:"lucide:send",class:"btn-icon"},null,t)),s(` ${o(v(y)?"جاري الإرسال...":"إرسال الرد")}</button></div></form></div></div>`)):s("\x3c!----\x3e"),s("</div>")}}}),b=y.setup;y.setup=(a,e)=>{const s=n();return(s.modules||(s.modules=new Set)).add("pages/admin/messages/index.vue"),b?b(a,e):void 0};const $=s(y,[["__scopeId","data-v-e1303f5a"]]);export{$ as default};
//# sourceMappingURL=index.vue9.mjs.map
