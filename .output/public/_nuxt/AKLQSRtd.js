import{_ as F}from"./B4HFk09F.js";import{z as K,i as U,m as g,e as ee,V as te,A as re,s as ne,P as ae,q as ie,c as d,o as c,a,b as G,t as m,g as s,D as R,d as se,F as oe,r as le,C as ue}from"./CPVxZRO5.js";import{u as W,_ as ce}from"./BenkRH5m.js";import{_ as de}from"./yhIIRsYM.js";import{u as me}from"./B5tq0e2L.js";import"./CXpDyb_a.js";const ve=()=>{const{locale:X}=K(),{getPackages:b}=W(),y=U(""),i=U({periods:[],priceRange:{min:0,max:1/0},duration:{min:0,max:1/0},dates:{start:null,end:null},travelers:1,type:[]}),w=g(()=>b()),u=g(()=>{const n=w.value||[];if(n.length===0)return{periods:[],priceRanges:[],durationRanges:[]};const l=new Set;n.forEach(v=>{v.travel_period&&l.add(v.travel_period)});const x=["january","february","march","april","may","june","july","august","september","october","november","december"],M=Array.from(l).sort((v,q)=>{const A=x.findIndex(_=>v.toLowerCase().includes(_)),C=x.findIndex(_=>q.toLowerCase().includes(_));return A-C}),z={january:{en:"January",ar:"يناير"},february:{en:"February",ar:"فبراير"},march:{en:"March",ar:"مارس"},april:{en:"April",ar:"أبريل"},may:{en:"May",ar:"مايو"},june:{en:"June",ar:"يونيو"},july:{en:"July",ar:"يوليو"},august:{en:"August",ar:"أغسطس"},september:{en:"September",ar:"سبتمبر"},october:{en:"October",ar:"أكتوبر"},november:{en:"November",ar:"نوفمبر"},december:{en:"December",ar:"ديسمبر"}};return{periods:M.map(v=>({id:v,name:z[v]||{en:v,ar:v}})),priceRanges:[{min:0,max:1e3,label:"Under $1,000"},{min:1e3,max:3e3,label:"$1,000 - $3,000"},{min:3e3,max:5e3,label:"$3,000 - $5,000"},{min:5e3,max:1/0,label:"Over $5,000"}],durationRanges:[{min:0,max:3,label:"1-3 days"},{min:4,max:7,label:"4-7 days"},{min:8,max:14,label:"8-14 days"},{min:15,max:1/0,label:"15+ days"}]}}),j=g(()=>{let n=w.value||[];if(y.value){const l=y.value.toLowerCase();n=n.filter(x=>x.title_en.toLowerCase().includes(l)||x.description_en.toLowerCase().includes(l))}return i.value.periods.length>0&&(n=n.filter(l=>i.value.periods.some(x=>l.travel_period.toLowerCase()===x.toLowerCase()))),(i.value.priceRange.min>0||i.value.priceRange.max<1/0)&&(n=n.filter(l=>l.price>=i.value.priceRange.min&&l.price<=i.value.priceRange.max)),(i.value.duration.min>0||i.value.duration.max<1/0)&&(n=n.filter(l=>l.duration_days>=i.value.duration.min&&l.duration_days<=i.value.duration.max)),n}),P=g(()=>{let n=0;return n+=i.value.periods.length,(i.value.priceRange.min!==0||i.value.priceRange.max!==1/0)&&n++,(i.value.duration.min!==0||i.value.duration.max!==1/0)&&n++,i.value.dates.start&&i.value.dates.end&&n++,i.value.travelers>1&&n++,n});return{searchQuery:y,filters:i,filterOptions:u,filteredPackages:j,activeFiltersCount:P,resetFilters:()=>{y.value="",i.value={periods:[],priceRange:{min:0,max:1/0},duration:{min:0,max:1/0},dates:{start:null,end:null},travelers:1,type:[]}}}},pe={class:"min-h-screen bg-gray-50"},fe={class:"relative bg-cover bg-center py-20"},xe={class:"absolute inset-0"},ye={class:"container relative z-10 mx-auto px-4 text-center text-white"},he={class:"text-2xl md:text-3xl font-bold mb-4"},ge={class:"flex items-center justify-center text-1xl gap-2 text-sm md:text-base mb-6 w-full"},be={key:0},we={key:1},_e={class:"flex flex-wrap justify-center gap-3 mb-8"},Ie={key:0,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},Re={key:1,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},Me={key:2,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},Ce={key:3,class:"flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full"},Le={class:"py-16"},$e={class:"container mx-auto px-4"},je={key:0,class:"flex justify-center items-center min-h-[400px]"},Pe={key:1,class:"text-center text-red-500"},ze={key:2,class:"text-center"},qe={class:"text-xl text-gray-600"},Ae={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},Oe=ee({__name:"search",async setup(X){let b,y;const i=te(),w=re(),{t:u,locale:j}=K(),{getPackages:P}=W(),{filters:t,searchQuery:n,filterOptions:l,resetFilters:x}=ve();ne(()=>{const e=i.query;if(x(),e.q&&(n.value=String(e.q)),e.periods){const r=Array.isArray(e.periods)?e.periods:e.periods.split(",");t.value.destinations=r.map(o=>String(o))}if(e.budget)switch(String(e.budget)){case"low":t.value.priceRange={min:0,max:1e3};break;case"medium":t.value.priceRange={min:1e3,max:3e3};break;case"high":t.value.priceRange={min:3e3,max:5e3};break;case"luxury":t.value.priceRange={min:5e3,max:1/0};break}else(e.priceMin||e.priceMax)&&(t.value.priceRange={min:parseInt(e.priceMin)||0,max:e.priceMax?parseInt(e.priceMax):1/0});(e.durationMin||e.durationMax)&&(t.value.duration={min:parseInt(e.durationMin)||0,max:e.durationMax?parseInt(e.durationMax):1/0}),e.travelers&&(t.value.travelers=parseInt(e.travelers)||1)});const{data:M,pending:z,error:v}=([b,y]=ae(()=>me("packages",()=>P(),{default:()=>[]})),b=await b,y(),b),q=g(()=>{var e;return(e=t.value)!=null&&e.destinations?t.value.destinations.map(r=>{var p,f,I;const o=(f=(p=l.value)==null?void 0:p.destinations)==null?void 0:f.find($=>$.id===r);return((I=o==null?void 0:o.name)==null?void 0:I[j.value])||r}):[]}),A=g(()=>{var e,r,o,p,f;return t.value?(((e=t.value.destinations)==null?void 0:e.length)||0)>0||(((r=t.value.priceRange)==null?void 0:r.min)||0)!==0||(((o=t.value.priceRange)==null?void 0:o.max)||1/0)!==1/0||(((p=t.value.duration)==null?void 0:p.min)||0)!==0||(((f=t.value.duration)==null?void 0:f.max)||1/0)!==1/0||(t.value.travelers||1)>1:!1}),C=()=>{x(),w.push({path:i.path})},_=e=>e.max===1/0?`${u("common.from")} ${e.min.toLocaleString()}`:`${e.min.toLocaleString()} - ${e.max.toLocaleString()}`,Y=e=>e.max===1/0?`${u("common.from")} ${e.min} ${u("common.days")}`:`${e.min} - ${e.max} ${u("common.days")}`,L=g(()=>M.value?M.value.filter(e=>{var r,o,p,f,I,$,B,N,V,k,D,O,J,E,T,H;if(n.value){const h=n.value.toLowerCase(),Q=((r=e.title_en)==null?void 0:r.toLowerCase().includes(h))||((o=e.title_ar)==null?void 0:o.toLowerCase().includes(h)),S=((p=e.description_en)==null?void 0:p.toLowerCase().includes(h))||((f=e.description_ar)==null?void 0:f.toLowerCase().includes(h));if(!Q&&!S)return!1}if((($=(I=t.value)==null?void 0:I.destinations)==null?void 0:$.length)>0){const h=(B=e==null?void 0:e.travel_period)==null?void 0:B.toLowerCase();if(!h||!t.value.destinations.some(S=>{const Z=S.toLowerCase();return h.includes(Z)}))return!1}return!((e==null?void 0:e.price_per_person)<(((V=(N=t.value)==null?void 0:N.priceRange)==null?void 0:V.min)||0)||((D=(k=t.value)==null?void 0:k.priceRange)==null?void 0:D.max)!==1/0&&(e==null?void 0:e.price_per_person)>t.value.priceRange.max||(e==null?void 0:e.duration_days)<(((J=(O=t.value)==null?void 0:O.duration)==null?void 0:J.min)||0)||((T=(E=t.value)==null?void 0:E.duration)==null?void 0:T.max)!==1/0&&(e==null?void 0:e.duration_days)>t.value.duration.max||(((H=t.value)==null?void 0:H.travelers)||1)>1&&(e==null?void 0:e.max_persons)<t.value.travelers)}):[]);return ie([t,n],([e,r])=>{var o;w.replace({query:{...r&&{q:r},...((o=e.destinations)==null?void 0:o.length)&&{periods:e.destinations.join(",")},...e.priceRange.min>0&&{priceMin:e.priceRange.min},...e.priceRange.max<1/0&&{priceMax:e.priceRange.max},...e.duration.min>0&&{durationMin:e.duration.min},...e.duration.max<1/0&&{durationMax:e.duration.max},...e.travelers>1&&{travelers:e.travelers}}})},{deep:!0}),(e,r)=>{var p;const o=F;return c(),d("div",pe,[a("section",fe,[a("div",xe,[G(o,{src:"/images/packages/home/packages-hero-bg.jpeg",alt:"Stunning beachfront villa with private pool and ocean views",width:"1920",height:"1080",loading:"eager",format:"webp",quality:"90",class:"w-full h-full object-cover",placeholder:""}),r[0]||(r[0]=a("div",{class:"absolute inset-0 bg-gradient-to-b from-black/50 via-black/30 to-black/50"},null,-1))]),a("div",ye,[a("h1",he,m(s(u)("search.results.title")),1),a("div",ge,[L.value.length>0?(c(),d("span",be,m(s(u)("search.results.count",{count:L.value.length})),1)):(c(),d("span",we,m(s(u)("search.results.empty")),1))]),a("div",_e,[(p=s(t))!=null&&p.destinations&&s(t).destinations.length?(c(),d("div",Ie,[r[1]||(r[1]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})],-1)),a("span",null,m(q.value.join(", ")),1)])):R("",!0),s(t).priceRange.min!==0||s(t).priceRange.max!==1/0?(c(),d("div",Re,[G(ce,{size:20,class:"text-white"}),a("span",null,m(_(s(t).priceRange)),1)])):R("",!0),s(t).duration.min!==0||s(t).duration.max!==1/0?(c(),d("div",Me,[r[2]||(r[2]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1)),a("span",null,m(Y(s(t).duration)),1)])):R("",!0),s(t).travelers>1?(c(),d("div",Ce,[r[3]||(r[3]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})],-1)),a("span",null,m(s(t).travelers)+" "+m(s(u)("search.travelers_count",{count:s(t).travelers})),1)])):R("",!0),A.value?(c(),d("button",{key:4,onClick:C,class:"flex items-center gap-2 bg-primary/20 hover:bg-primary/30 backdrop-blur-sm px-4 py-2 rounded-full transition-colors"},[r[4]||(r[4]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)),se(" "+m(s(u)("search.active_filters.clear_filters")),1)])):R("",!0)])])]),a("section",Le,[a("div",$e,[s(z)?(c(),d("div",je,r[5]||(r[5]=[a("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent"},null,-1)]))):s(v)?(c(),d("div",Pe,m(s(u)("common.error")),1)):L.value.length===0?(c(),d("div",ze,[a("p",qe,m(s(u)("search.results.empty")),1),a("button",{onClick:C,class:"mt-4 px-6 py-2 bg-primary text-white rounded-xl hover:bg-primary/90 transition-colors"},m(s(u)("search.actions.clear_filters")),1)])):(c(),d("div",Ae,[(c(!0),d(oe,null,le(L.value,f=>(c(),ue(de,{key:f.id,package_:f},null,8,["package_"]))),128))]))])])])}}});export{Oe as default};
