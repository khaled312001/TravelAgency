import{e as P,i as u,m as f,s as ss,u as es,c as r,o as d,a as s,D as x,b as c,d as b,h as ts,t as l,g as a,E as k,G as j,Y as w,X as $,O as q,F as A,r as B,n as T,H as C,C as H,_ as as}from"./4AaFNmA5.js";const os={class:"messages-page space-y-4"},ls={class:"page-header"},ns={class:"header-content"},is={class:"header-right"},ds={class:"stats-grid"},cs={class:"stat-card"},rs={class:"stat-icon"},us={class:"stat-content"},ps={class:"stat-value"},vs={class:"stat-card"},_s={class:"stat-icon"},ms={class:"stat-content"},gs={class:"stat-value"},hs={class:"stat-card"},ys={class:"stat-icon"},fs={class:"stat-content"},bs={class:"stat-value"},ks={class:"stat-card"},Cs={class:"stat-icon"},Ms={class:"stat-content"},xs={class:"stat-value"},ws={class:"filters-section"},Ts={class:"filters-container"},Ls={class:"search-box"},Ss={class:"filter-controls"},Vs={class:"messages-container"},Ds={key:0,class:"loading-state"},js={key:1,class:"empty-state"},Es={key:2,class:"messages-list"},Fs=["onClick"],Rs={class:"message-header"},Ns={class:"sender-info"},Us={class:"sender-avatar"},Zs={class:"sender-details"},$s={class:"sender-name"},qs={class:"sender-email"},As={class:"message-meta"},Bs={class:"message-date"},Hs={class:"message-content"},Is={class:"message-subject"},zs={class:"message-preview"},Gs={class:"message-footer"},Os={class:"message-status"},Qs={class:"message-actions"},Ws=["onClick"],Xs=["onClick"],Ys={class:"modal-header"},Js={key:0,class:"modal-body"},Ks={class:"message-details"},Ps={class:"message-header-detail"},se={class:"sender-info-detail"},ee={class:"sender-avatar-large"},te={class:"sender-details-large"},ae={class:"sender-name-large"},oe={class:"sender-email-large"},le={class:"sender-phone"},ne={class:"message-meta-detail"},ie={class:"message-date-large"},de={class:"message-content-detail"},ce={class:"message-subject-large"},re={class:"message-text"},ue={key:0,class:"replies-section"},pe={class:"replies-list"},ve={class:"reply-header"},_e={class:"reply-author"},me={class:"reply-date"},ge={class:"reply-content"},he={class:"modal-actions"},ye={class:"modal-header"},fe={class:"form-group"},be={class:"modal-actions"},ke=["disabled"],Ce=P({__name:"index",setup(Me){const v=u([]),L=u(!0),_=u(!1),p=u(""),m=u(""),g=u(""),h=u(""),S=u(!1),V=u(!1),n=u(null),y=u({message:""}),E=f(()=>{let t=v.value;return p.value&&(t=t.filter(e=>e.sender_name.toLowerCase().includes(p.value.toLowerCase())||e.sender_email.toLowerCase().includes(p.value.toLowerCase())||e.subject.toLowerCase().includes(p.value.toLowerCase())||e.message.toLowerCase().includes(p.value.toLowerCase()))),m.value&&(t=t.filter(e=>e.status===m.value)),g.value&&(t=t.filter(e=>e.type===g.value)),h.value&&(t=t.filter(e=>e.created_at.startsWith(h.value))),t}),I=f(()=>v.value.length),z=f(()=>v.value.filter(t=>t.status==="unread").length),G=f(()=>v.value.filter(t=>t.status==="replied").length),O=f(()=>v.value.filter(t=>t.status==="pending").length),Q=t=>({unread:"غير مقروء",read:"مقروء",replied:"مجاب",pending:"في الانتظار"})[t]||t,F=t=>({inquiry:"استفسار",complaint:"شكوى",suggestion:"اقتراح",booking:"حجز"})[t]||t,W=t=>new Date(t).toLocaleDateString("ar-SA"),R=t=>new Date(t).toLocaleString("ar-SA"),N=async()=>{try{L.value=!0,v.value=[{id:"msg-001",sender_name:"أحمد محمد",sender_email:"ahmed@example.com",sender_phone:"+966501234567",subject:"استفسار عن رحلة دبي",message:"أرغب في معرفة تفاصيل رحلة دبي المتاحة في شهر مارس، وما هي الخدمات المدرجة في السعر؟",type:"inquiry",status:"unread",created_at:"2024-01-15T10:00:00Z",updated_at:"2024-01-15T10:00:00Z"},{id:"msg-002",sender_name:"فاطمة علي",sender_email:"fatima@example.com",sender_phone:"+966507654321",subject:"شكوى في الخدمة",message:"واجهت مشكلة في خدمة العملاء أثناء حجز رحلتي الأخيرة، وأرغب في تقديم شكوى رسمية.",type:"complaint",status:"read",created_at:"2024-01-20T14:30:00Z",updated_at:"2024-01-20T14:30:00Z",replies:[{id:"reply-001",author_name:"فريق خدمة العملاء",message:"نعتذر عن المشكلة التي واجهتها. سنقوم بمراجعة الأمر وإصلاحه في أقرب وقت ممكن.",created_at:"2024-01-21T09:00:00Z"}]}]}catch(t){console.error("Error loading messages:",t)}finally{L.value=!1}},X=t=>{n.value=t,S.value=!0,t.status==="unread"&&(t.status="read")},U=t=>{n.value=t,V.value=!0,y.value.message=""},Y=async()=>{try{_.value=!0,console.log("Send reply:",y.value.message),n.value&&(n.value.status="replied"),M()}catch(t){console.error("Error sending reply:",t)}finally{_.value=!1}},J=async t=>{if(confirm(`هل أنت متأكد من حذف الرسالة من ${t.sender_name}؟`))try{console.log("Delete message:",t.id),await N()}catch(e){console.error("Error deleting message:",e)}},K=async()=>{try{v.value.forEach(t=>{t.status==="unread"&&(t.status="read")})}catch(t){console.error("Error marking all as read:",t)}},D=()=>{S.value=!1,n.value=null},M=()=>{V.value=!1,n.value=null,y.value.message=""};return ss(()=>{N()}),es({title:"إدارة الرسائل - لوحة التحكم"}),(t,e)=>{const i=ts;return d(),r("div",os,[s("div",ls,[s("div",ns,[e[9]||(e[9]=s("div",{class:"header-left"},[s("h1",{class:"page-title"},"إدارة الرسائل"),s("p",{class:"page-subtitle"},"إدارة رسائل التواصل من العملاء")],-1)),s("div",is,[s("button",{onClick:K,class:"mark-read-btn"},[c(i,{name:"lucide:check",class:"btn-icon"}),e[8]||(e[8]=b(" تعيين الكل كمقروء "))])])])]),s("div",ds,[s("div",cs,[s("div",rs,[c(i,{name:"lucide:mail",class:"icon"})]),s("div",us,[s("p",ps,l(a(I)),1),e[10]||(e[10]=s("p",{class:"stat-label"},"إجمالي الرسائل",-1))])]),s("div",vs,[s("div",_s,[c(i,{name:"lucide:mail-open",class:"icon"})]),s("div",ms,[s("p",gs,l(a(z)),1),e[11]||(e[11]=s("p",{class:"stat-label"},"الرسائل غير المقروءة",-1))])]),s("div",hs,[s("div",ys,[c(i,{name:"lucide:reply",class:"icon"})]),s("div",fs,[s("p",bs,l(a(G)),1),e[12]||(e[12]=s("p",{class:"stat-label"},"الرسائل المجابة",-1))])]),s("div",ks,[s("div",Cs,[c(i,{name:"lucide:clock",class:"icon"})]),s("div",Ms,[s("p",xs,l(a(O)),1),e[13]||(e[13]=s("p",{class:"stat-label"},"في الانتظار",-1))])])]),s("div",ws,[s("div",Ts,[s("div",Ls,[c(i,{name:"lucide:search",class:"search-icon"}),k(s("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>w(p)?p.value=o:null),type:"text",placeholder:"البحث في الرسائل...",class:"search-input"},null,512),[[j,a(p)]])]),s("div",Ss,[k(s("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>w(m)?m.value=o:null),class:"filter-select"},e[14]||(e[14]=[q('<option value="" data-v-e1303f5a>جميع الحالات</option><option value="unread" data-v-e1303f5a>غير مقروء</option><option value="read" data-v-e1303f5a>مقروء</option><option value="replied" data-v-e1303f5a>مجاب</option><option value="pending" data-v-e1303f5a>في الانتظار</option>',5)]),512),[[$,a(m)]]),k(s("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>w(g)?g.value=o:null),class:"filter-select"},e[15]||(e[15]=[q('<option value="" data-v-e1303f5a>جميع الأنواع</option><option value="inquiry" data-v-e1303f5a>استفسار</option><option value="complaint" data-v-e1303f5a>شكوى</option><option value="suggestion" data-v-e1303f5a>اقتراح</option><option value="booking" data-v-e1303f5a>حجز</option>',5)]),512),[[$,a(g)]]),k(s("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>w(h)?h.value=o:null),type:"date",class:"filter-select",placeholder:"تاريخ الرسالة"},null,512),[[j,a(h)]])])])]),s("div",Vs,[a(L)?(d(),r("div",Ds,e[16]||(e[16]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"جاري تحميل الرسائل...",-1)]))):a(E).length===0?(d(),r("div",js,[c(i,{name:"lucide:mail",class:"empty-icon"}),e[17]||(e[17]=s("h3",null,"لا توجد رسائل",-1)),e[18]||(e[18]=s("p",null,"لم يتم العثور على أي رسائل تطابق معايير البحث",-1))])):(d(),r("div",Es,[(d(!0),r(A,null,B(a(E),o=>(d(),r("div",{key:o.id,class:T(["message-card",{unread:o.status==="unread"}]),onClick:Z=>X(o)},[s("div",Rs,[s("div",Ns,[s("div",Us,[c(i,{name:"lucide:user",class:"avatar-icon"})]),s("div",Zs,[s("h3",$s,l(o.sender_name),1),s("p",qs,l(o.sender_email),1)])]),s("div",As,[s("span",{class:T(["message-type",o.type])},l(F(o.type)),3),s("span",Bs,l(W(o.created_at)),1)])]),s("div",Hs,[s("h4",Is,l(o.subject),1),s("p",zs,l(o.message),1)]),s("div",Gs,[s("div",Os,[s("span",{class:T(["status-badge",o.status])},l(Q(o.status)),3)]),s("div",Qs,[s("button",{onClick:C(Z=>U(o),["stop"]),class:"action-btn reply"},[c(i,{name:"lucide:reply",class:"action-icon"}),e[19]||(e[19]=b(" رد "))],8,Ws),s("button",{onClick:C(Z=>J(o),["stop"]),class:"action-btn delete"},[c(i,{name:"lucide:trash-2",class:"action-icon"}),e[20]||(e[20]=b(" حذف "))],8,Xs)])])],10,Fs))),128))]))]),a(S)?(d(),r("div",{key:0,class:"modal-overlay",onClick:D},[s("div",{class:"modal-content large",onClick:e[5]||(e[5]=C(()=>{},["stop"]))},[s("div",Ys,[e[21]||(e[21]=s("h2",{class:"modal-title"},"تفاصيل الرسالة",-1)),s("button",{onClick:D,class:"modal-close"},[c(i,{name:"lucide:x",class:"close-icon"})])]),a(n)?(d(),r("div",Js,[s("div",Ks,[s("div",Ps,[s("div",se,[s("div",ee,[c(i,{name:"lucide:user",class:"avatar-icon-large"})]),s("div",te,[s("h3",ae,l(a(n).sender_name),1),s("p",oe,l(a(n).sender_email),1),s("p",le,l(a(n).sender_phone),1)])]),s("div",ne,[s("span",{class:T(["message-type-large",a(n).type])},l(F(a(n).type)),3),s("span",ie,l(R(a(n).created_at)),1)])]),s("div",de,[s("h4",ce,l(a(n).subject),1),s("div",re,l(a(n).message),1)]),a(n).replies&&a(n).replies.length>0?(d(),r("div",ue,[e[22]||(e[22]=s("h4",{class:"replies-title"},"الردود",-1)),s("div",pe,[(d(!0),r(A,null,B(a(n).replies,o=>(d(),r("div",{key:o.id,class:"reply-item"},[s("div",ve,[s("span",_e,l(o.author_name),1),s("span",me,l(R(o.created_at)),1)]),s("div",ge,l(o.message),1)]))),128))])])):x("",!0)])])):x("",!0),s("div",he,[s("button",{onClick:D,class:"btn-secondary"}," إغلاق "),s("button",{onClick:e[4]||(e[4]=o=>U(a(n))),class:"btn-primary"},[c(i,{name:"lucide:reply",class:"btn-icon"}),e[23]||(e[23]=b(" رد على الرسالة "))])])])])):x("",!0),a(V)?(d(),r("div",{key:1,class:"modal-overlay",onClick:M},[s("div",{class:"modal-content",onClick:e[7]||(e[7]=C(()=>{},["stop"]))},[s("div",ye,[e[24]||(e[24]=s("h2",{class:"modal-title"},"رد على الرسالة",-1)),s("button",{onClick:M,class:"modal-close"},[c(i,{name:"lucide:x",class:"close-icon"})])]),s("form",{onSubmit:C(Y,["prevent"]),class:"modal-form"},[s("div",fe,[e[25]||(e[25]=s("label",{class:"form-label"},"الرد *",-1)),k(s("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>a(y).message=o),class:"form-textarea",rows:"6",required:"",placeholder:"اكتب ردك هنا..."},null,512),[[j,a(y).message]])]),s("div",be,[s("button",{type:"button",onClick:M,class:"btn-secondary"}," إلغاء "),s("button",{type:"submit",class:"btn-primary",disabled:a(_)},[a(_)?(d(),H(i,{key:0,name:"lucide:loader-2",class:"btn-icon animate-spin"})):(d(),H(i,{key:1,name:"lucide:send",class:"btn-icon"})),b(" "+l(a(_)?"جاري الإرسال...":"إرسال الرد"),1)],8,ke)])],32)])])):x("",!0)])}}}),we=as(Ce,[["__scopeId","data-v-e1303f5a"]]);export{we as default};
